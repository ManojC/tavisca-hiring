<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../t-header/t-header.html">
<link rel="import" href="../t-notify/t-notify.html">
<link rel="import" href="../t-input/t-input.html">
<link rel="import" href="../t-input/t-textarea.html">
<link rel="import" href="../t-button/t-button.html">
<link rel="import" href="../t-dropdown/t-dropdown.html">
<link rel="import" href="../t-radio-group/t-radio-group.html">
<link rel="import" href="../t-text-container/travel-element-styles.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../t-app-footer/t-app-footer.html">
<link rel="import" href="tavisca-hiring-api.html">
<!--
A comment describing this element

Example:

    <tavisca-hiring-app>
      <h2>Hello tavisca-hiring-app</h2>
    </tavisca-hiring-app>

@demo demo/index.html
-->
<dom-module id="tavisca-hiring-app">
    <template>
        <style include="iron-flex"></style>
        <style include="travel-element-styles">
            :host {
                display: block;
                font-family: var(--header-font-family, --primary-font-family);
                font-size: var(--font-14, 14px);
            }

            .container { 
                background-color: rgb(249, 255, 235);
                -webkit-box-shadow: 0px 0px 44px -6px rgba(90,80,230,0.92);
                -moz-box-shadow: 0px 0px 44px -6px rgba(90,80,230,0.92);
                box-shadow: 0px 0px 44px -6px rgba(90,80,230,0.92);
            }

            t-button {
                display: block;
            }

            t-input.full, t-textarea, t-button, t-header, t-app-footer {
                min-width: 280px;
            }

            t-input.half {
                min-width: 135px;
            }

            t-radio-group {
                margin-top: 15px;
            }

            t-radio-group, t-dropdown{
                min-width: 140px;
            }            
        </style>

        <div class="layout horizontal">
            <div class="flex"></div>

            <div class="flex container section-small">

                <!-- header -->
                <div class="flex margin-bottom">
                    <t-header                            
                        hide-left-icon
                        normal-heading
                        label="Tavisca Recruitment Drive">                        
                    </t-header>
                </div>

                <!-- notification -->
                <div class="flex margin-bottom">
                    <t-notify
                        active
                        type="success"
                        message="Your information has been submitted successfully!">
                    </t-notify>
                </div>

                <!-- full name -->
                <div class="margin-bottom-medium">
                    <t-input
                        type="text"
                        class="flex full"
                        label="full name"
                        value="{{data.fullName}}"
                        error-message="First name is required."
                        required>
                    </t-input>
                </div>
                
                <!-- email -->
                <div class="margin-bottom-medium">
                    <t-input
                        type="text"
                        class="flex full"
                        label="email id"
                        value="{{data.emailId}}"
                        pattern='^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$'
                        error-message="Invalid email."
                        required>
                    </t-input>
                </div>

                <!-- phone number -->
                <div class="margin-bottom-medium">
                    <t-input
                        type="text"
                        class="flex full"
                        label="contact number"
                        value="{{data.phoneNumber}}"
                        pattern="^[\d, ,(,),+,-]+"
                        max-length="12" 
                        error-message="Invalid contact"
                        required>
                    </t-input>
                </div>
                
                <!-- degree, stream -->
                
                <div class="layout horizontal">
                    <t-radio-group
                        pill-button
                        class="flex"
                        selected-item="{{data.degree}}"
                        data='["BE","BTech"]'>
                    </t-radio-group>
                    <t-dropdown                                
                        label="Stream"
                        class="flex text-left"
                        error-message="Select stream"
                        selected-item="{{data.stream}}"
                        dropdown-array='["Comp","IT","E&TC"]'
                        required>
                    </t-dropdown>
                    <div class="flex"></div>
                </div>

                <!-- other streams -->
                <div class="margin-bottom-medium">
                    <t-input
                        type="text"
                        class="flex full"
                        label="other stream? specify."
                        value="{{data.otherStream}}">
                    </t-input>
                </div>

                <!-- 10th data -->
                <div class="margin-bottom-medium">
                    <div class="flex layout horizontal">
                        <t-input
                            type="text"
                            class="flex half"
                            pattern="^[\d,.]+"
                            max-length="5" 
                            label="10th percentage"
                            value="{{data.10thPercentage}}"
                            error-message="Percentage is required."
                            required>
                        </t-input>
                        &nbsp;&nbsp;
                        <t-input
                            type="text"
                            class="flex half"
                            label="10th passing year"
                            pattern="^[\d]+"
                            max-length="4" 
                            value="{{data.10thPassingYr}}"
                            error-message="Passing year is required."
                            required>
                        </t-input>
                    </div>
                </div>

                <!-- 10th school details -->
                <div class="margin-bottom-medium">
                    <t-textarea
                        type="text"                           
                        label="school details"
                        value="{{data.schoolDetails}}"
                        error-message="School name is required."
                        required>                        
                    </t-textarea>
                </div>

                <!-- 12th data -->
                <div class="margin-bottom-medium">
                    <div class="flex layout horizontal">
                        <t-input
                            type="text"
                            class="flex half"
                            pattern="^[\d,.]+"
                            max-length="5" 
                            label="12th percentage"
                            value="{{data.12thPercentage}}"
                            error-message="Percentage is required."
                            required>
                        </t-input>
                        &nbsp;&nbsp;
                        <t-input
                            type="text"
                            class="flex half"
                            label="12th Passing year"
                            pattern="^[\d]+"
                            max-length="4" 
                            value="{{data.12thPassingYr}}"
                            error-message="Passing year is required."
                            required>
                        </t-input>
                    </div>
                </div>

                <!-- 12th school details -->
                <div class="margin-bottom-medium">
                    <t-textarea
                        type="text"                           
                        label="12th college details"
                        value="{{data.12thCollegeDetails}}"
                        error-message="College name is required."
                        required>                        
                    </t-textarea>
                </div>

                <!-- Degree data -->
                <div class="margin-bottom-medium">
                    <div class="flex layout horizontal">
                        <t-input
                            type="text"
                            class="flex half"
                            pattern="^[\d,.]+"
                            max-length="5" 
                            label="degree percentage"
                            value="{{data.degreePercentage}}"
                            error-message="Percentage is required."
                            required>
                        </t-input>
                        &nbsp;&nbsp;
                        <t-input
                            type="text"
                            class="flex half"
                            label="degree Passing year"
                            pattern="^[\d]+"
                            max-length="4" 
                            value="{{data.degreePassingYr}}"
                            error-message="Passing year is required."
                            required>
                        </t-input>
                    </div>
                </div>

                <!-- Degree college details -->
                <div class="margin-bottom-large">
                    <t-textarea
                        type="text"                           
                        label="degree college details"
                        value="{{data.degreeCollegeDetails}}"
                        error-message="College name is required."
                        required>                        
                    </t-textarea>
                </div>

                <!-- Submit Button -->
                <div class=" flex margin-bottom-large">
                    <t-button
                        label="submit details"
                        class="primary"
                        on-click="submit">
                    </t-button>
                </div>

                <!-- footer -->
                <div class="flex">
                    <t-app-footer></t-app-footer>
                </div>
            </div>

            <div class="flex"></div>                
        </div>

        <tavisca-hiring-api
            id="submitApi" 
            loading={{loading}} 
            api-base-url="[[apiBaseUrl]]" 
            api-relative-url="api/ShoppingCart/book" 
            auth-token="[[authToken]]"
            on-tavisca-hiring-api-success="_onSubmitSuccess"
            on-tavisca-hiring-api-error="_onSubmitError">                
        </tavisca-hiring-api>

    </template>

    <script>
        (function () {

            'use strict'

            Polymer({

                is: 'tavisca-hiring-app',

                properties: {
                    data: {
                        type: Object,
                        value: {
                            degree: 'BE',
                            stream: 'Comp'
                        }
                    }
                },

                validate: function() {
                    var check = true;
                    var requiredFields = this.querySelectorAll('[required]');
                    for (var i = 0; i < requiredFields.length; i++) {
                        if (requiredFields[i].validate && typeof requiredFields[i].validate === 'function' && !requiredFields[i].validate()) {
                            check = false;
                        }
                    }
                    return check;
                },

                submit: function () {

                    if (this.validate()) {
                        this.$.submitApi.submit(this.data);
                    }                
                },

                _onSubmitSuccess: function (e) {
                    console.log(e.detail);
                    this._reset();
                },

                _onSubmitError: function (e) {
                    // console.log(e.detail);                    
                },

                _reset: function () {
                    this.data = {
                        degree: 'BE',
                        stream: 'Comp'
                    };
                }
            });

        })();
    </script>
</dom-module>
